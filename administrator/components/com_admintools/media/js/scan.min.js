/*
 Copyright (c)2010-2018 Nicholas K. Dionysopoulos / Akeeba Ltd
  @license GNU General Public License version 3, or later
*/
var admintools_scan_ajax_url_start="",admintools_scan_ajax_url_step="",admintools_scan_error_callback=scan_dummy_error_handler,admintools_scan_msg_ago="",admintools_scan_timerid=-1,admintools_scan_responseago=0;function scan_dummy_error_handler(a){alert(a);window.location="index.php?option=com_admintools&view=Scans"}
function doScanAjax(a,f,e){akeeba.jQuery.ajax({type:"GET",url:a,cache:!1,timeout:6E5,success:function(b){var d="",c=b.indexOf("###");if(-1==c)b="Invalid AJAX data: "+b,null==e?null!=admintools_scan_error_callback&&admintools_scan_error_callback(b):e(b);else{d=0!=c?b.substr(c):b;d=d.substr(3);c=d.lastIndexOf("###");d=d.substr(0,c);try{var a=JSON.parse(d)}catch(g){b=g.message+"\n<br/>\n<pre>\n"+d+"\n</pre>";null==e?null!=admintools_scan_error_callback&&admintools_scan_error_callback(b):e(b);return}f(a)}},
error:function(b,a,c){c="<strong>AJAX Loading Error</strong><br/>HTTP Status: "+b.status+" ("+b.statusText+")<br/>";c=c+"Internal status: "+a+"<br/>XHR ReadyState: "+b.readyState+"<br/>";c=c+"Raw server response:<br/>"+b.responseText;null==e?null!=admintools_scan_error_callback&&admintools_scan_error_callback(c):e(c)}})}
function startScan(){admintools.Modal.open({inherit:"#admintools-scan-dim",width:"350px",height:"160px",hideClose:!0,lock:!0});doScanAjax(admintools_scan_ajax_url_start,function(a){processScanStep(a)})}function processScanStep(a){stop_scan_timer();!1==a.status?admintools_scan_error_callback(a.error):a.done?window.location="index.php?option=com_admintools&view=Scans":(start_scan_timer(),doScanAjax(admintools_scan_ajax_url_step,function(a){processScanStep(a)}))}
function start_scan_timer(){0<=admintools_scan_timerid&&window.clearInterval(admintools_scan_timerid);admintools_scan_responseago=0;set_scan_timermsg();admintools_scan_timerid=window.setInterval("step_scan_timer()",1E3)}function step_scan_timer(){admintools_scan_responseago++;set_scan_timermsg()}function stop_scan_timer(){0<=admintools_scan_timerid&&window.clearInterval(admintools_scan_timerid)}
function set_scan_timermsg(){document.getElementById("admintools-lastupdate-text").innerHTML=admintools_scan_msg_ago.replace("%s",admintools_scan_responseago)}; //# sourceMappingURL=scan.min.map
